/* ══════════════════════════════════════════════════
   ChatFaces – Background Layer & Transparency Overrides
   ══════════════════════════════════════════════════ */

/* ── Background layer (injected by content.js) ── */
#chatfaces-bg-layer {
  position: fixed;
  inset: 0;
  z-index: -1;
  background-size: contain;
  background-position: center bottom;
  background-repeat: no-repeat;
  background-color: #0a0a14;
  pointer-events: none;
  opacity: 0;
  transition: opacity 2s cubic-bezier(0.25, 0, 0.15, 1);
}

#chatfaces-bg-layer.chatfaces-visible {
  opacity: 1;
}

/* Fade-out when removing */
#chatfaces-bg-layer.chatfaces-fade-out {
  opacity: 0;
  transition: opacity 1.2s cubic-bezier(0.25, 0, 0.15, 1);
}

/* ══════════════════════════════════════════════════
   Per-message readable panels
   Each chat message gets a dark semi-transparent
   background so text is readable while the BG image
   stays fully visible between messages.
   ══════════════════════════════════════════════════ */

/* ── ChatGPT message bubbles ── */
html[data-chatfaces-site="chatgpt"] body.chatfaces-transparent article[data-testid^="conversation-turn"] {
  background: rgba(10, 10, 20, 0.60) !important;
  border-radius: 16px !important;
  padding: 12px 16px !important;
  margin-bottom: 8px !important;
  backdrop-filter: blur(6px) !important;
  -webkit-backdrop-filter: blur(6px) !important;
}

/* ── ChatGPT input bar area ── */
html[data-chatfaces-site="chatgpt"] body.chatfaces-transparent form {
  background: rgba(10, 10, 20, 0.55) !important;
  border-radius: 16px !important;
  backdrop-filter: blur(6px) !important;
  -webkit-backdrop-filter: blur(6px) !important;
}

/* ── Claude message bubbles ── */
html[data-chatfaces-site="claude"] body.chatfaces-transparent [data-testid="user-message"],
html[data-chatfaces-site="claude"] body.chatfaces-transparent [data-testid="assistant-message"],
html[data-chatfaces-site="claude"] body.chatfaces-transparent .font-claude-message,
html[data-chatfaces-site="claude"] body.chatfaces-transparent .font-user-message {
  background: rgba(10, 10, 20, 0.60) !important;
  border-radius: 16px !important;
  padding: 12px 16px !important;
  margin-bottom: 8px !important;
  backdrop-filter: blur(6px) !important;
  -webkit-backdrop-filter: blur(6px) !important;
}

/* ── Claude input bar ── */
html[data-chatfaces-site="claude"] body.chatfaces-transparent [class*="ProseMirror"],
html[data-chatfaces-site="claude"] body.chatfaces-transparent fieldset {
  background: rgba(10, 10, 20, 0.55) !important;
  border-radius: 16px !important;
  backdrop-filter: blur(6px) !important;
  -webkit-backdrop-filter: blur(6px) !important;
}

/* ── Gemini message bubbles ── */
html[data-chatfaces-site="gemini"] body.chatfaces-transparent message-content,
html[data-chatfaces-site="gemini"] body.chatfaces-transparent .query-content,
html[data-chatfaces-site="gemini"] body.chatfaces-transparent .response-container-content,
html[data-chatfaces-site="gemini"] body.chatfaces-transparent .conversation-turn {
  background: rgba(10, 10, 20, 0.60) !important;
  border-radius: 16px !important;
  padding: 12px 16px !important;
  margin-bottom: 8px !important;
  backdrop-filter: blur(6px) !important;
  -webkit-backdrop-filter: blur(6px) !important;
}

/* ── Gemini input bar ── */
html[data-chatfaces-site="gemini"] body.chatfaces-transparent .input-area-container,
html[data-chatfaces-site="gemini"] body.chatfaces-transparent rich-textarea {
  background: rgba(10, 10, 20, 0.55) !important;
  border-radius: 16px !important;
  backdrop-filter: blur(6px) !important;
  -webkit-backdrop-filter: blur(6px) !important;
}

/* ── Ensure text stays light and readable on all sites ── */
html[data-chatfaces-site] body.chatfaces-transparent article[data-testid^="conversation-turn"] *,
html[data-chatfaces-site] body.chatfaces-transparent [data-testid="user-message"] *,
html[data-chatfaces-site] body.chatfaces-transparent [data-testid="assistant-message"] *,
html[data-chatfaces-site] body.chatfaces-transparent .font-claude-message *,
html[data-chatfaces-site] body.chatfaces-transparent message-content *,
html[data-chatfaces-site] body.chatfaces-transparent .conversation-turn * {
  color: #e8e8ee !important;
}

/* ══════════════════════════════════════════════════
   Site-specific transparency overrides
   These make the native backgrounds see-through so
   our custom background shows through.
   ══════════════════════════════════════════════════ */

/* ── ChatGPT (chatgpt.com / chat.openai.com) ── */
html[data-chatfaces-site="chatgpt"] body.chatfaces-transparent,
html[data-chatfaces-site="chatgpt"] body.chatfaces-transparent .flex.h-full,
html[data-chatfaces-site="chatgpt"] body.chatfaces-transparent main,
html[data-chatfaces-site="chatgpt"] body.chatfaces-transparent .relative.flex.h-full,
html[data-chatfaces-site="chatgpt"] body.chatfaces-transparent div.relative.flex.h-full.max-w-full,
html[data-chatfaces-site="chatgpt"] body.chatfaces-transparent .overflow-y-auto {
  background-color: transparent !important;
  background-image: none !important;
}

/* The main chat column */
html[data-chatfaces-site="chatgpt"] body.chatfaces-transparent .flex-1.overflow-hidden,
html[data-chatfaces-site="chatgpt"] body.chatfaces-transparent [class*="react-scroll-to-bottom"],
html[data-chatfaces-site="chatgpt"] body.chatfaces-transparent .h-full.w-full {
  background-color: transparent !important;
  background-image: none !important;
}

/* ── Claude (claude.ai) ── */
html[data-chatfaces-site="claude"] body.chatfaces-transparent,
html[data-chatfaces-site="claude"] body.chatfaces-transparent main,
html[data-chatfaces-site="claude"] body.chatfaces-transparent .flex-1,
html[data-chatfaces-site="claude"] body.chatfaces-transparent [class*="min-h-screen"],
html[data-chatfaces-site="claude"] body.chatfaces-transparent [class*="bg-bg"],
html[data-chatfaces-site="claude"] body.chatfaces-transparent [class*="bg-white"],
html[data-chatfaces-site="claude"] body.chatfaces-transparent [class*="bg-stone"],
html[data-chatfaces-site="claude"] body.chatfaces-transparent [class*="bg-cream"],
html[data-chatfaces-site="claude"] body.chatfaces-transparent .contents,
html[data-chatfaces-site="claude"] body.chatfaces-transparent .flex.min-h-full {
  background-color: transparent !important;
  background-image: none !important;
}

/* ── Gemini (gemini.google.com) ── */
html[data-chatfaces-site="gemini"] body.chatfaces-transparent,
html[data-chatfaces-site="gemini"] body.chatfaces-transparent main,
html[data-chatfaces-site="gemini"] body.chatfaces-transparent .conversation-container,
html[data-chatfaces-site="gemini"] body.chatfaces-transparent [class*="chat-window"],
html[data-chatfaces-site="gemini"] body.chatfaces-transparent [class*="response-container"],
html[data-chatfaces-site="gemini"] body.chatfaces-transparent mat-sidenav-content,
html[data-chatfaces-site="gemini"] body.chatfaces-transparent .gmat-body-medium,
html[data-chatfaces-site="gemini"] body.chatfaces-transparent [class*="main-container"] {
  background-color: transparent !important;
  background-image: none !important;
}
